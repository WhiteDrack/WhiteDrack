<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Jump Tracker</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; background: #0f172a; color: white; margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; }
        .card { background: #1e293b; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.5); width: 80%; max-width: 400px; }
        #height { font-size: 64px; font-weight: bold; color: #38bdf8; margin: 20px 0; }
        button { padding: 15px 40px; font-size: 18px; cursor: pointer; background: #38bdf8; border: none; border-radius: 50px; color: #0f172a; font-weight: bold; transition: 0.3s; }
        button:active { transform: scale(0.95); }
        .status-box { margin-top: 20px; font-size: 14px; color: #94a3b8; }
        .indicator { width: 15px; height: 15px; border-radius: 50%; display: inline-block; background: #64748b; margin-right: 5px; }
        .active-jump { background: #f43f5e; animation: blink 0.5s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <div class="card">
        <h2>Phone Jump ðŸš€</h2>
        <div id="height">0.00m</div>
        <button id="startBtn">START SENSOR</button>
        
        <div class="status-box">
            <span id="indicator" class="indicator"></span>
            <span id="status">Ready to track</span>
        </div>
    </div>

    <script>
        let isFreeFalling = false;
        let startTime = 0;
        let lastJumpTime = 0;
        const DEBOUNCE_TIME = 1000; // 1 second gap between jumps

        const heightDisplay = document.getElementById('height');
        const statusText = document.getElementById('status');
        const indicator = document.getElementById('indicator');
        const startBtn = document.getElementById('startBtn');

        function startTracking() {
            if (typeof DeviceMotionEvent.requestPermission === 'function') {
                DeviceMotionEvent.requestPermission().then(permissionState => {
                    if (permissionState === 'granted') {
                        setupListener();
                    }
                });
            } else {
                setupListener();
            }
            startBtn.style.display = 'none';
            statusText.innerText = "Monitoring Motion...";
        }

        function setupListener() {
            window.addEventListener('devicemotion', (event) => {
                let acc = event.accelerationIncludingGravity;
                if (!acc.x) return;

                // Magnitude calculate karna
                let totalAcc = Math.sqrt(acc.x**2 + acc.y**2 + acc.z**2);
                
                let now = performance.now();

                // 1. FREEFALL DETECT (Jump start)
                // Gravity 9.8 hoti hai, agar 3 se niche jaye matlab phone hawa mein hai
                if (totalAcc < 3.0 && !isFreeFalling && (now - lastJumpTime > DEBOUNCE_TIME)) {
                    isFreeFalling = true;
                    startTime = now;
                    indicator.classList.add('active-jump');
                    statusText.innerText = "AIRBORNE!";
                }

                // 2. CATCH DETECT (Jump end)
                // Jab phone hath mein wapas aaye, impact 13+ acceleration generate karega
                if (isFreeFalling && totalAcc > 13.0) {
                    let duration = (now - startTime) / 1000; // Seconds mein
                    
                    // Valid jump duration check (0.1s se 3s tak)
                    if (duration > 0.15 && duration < 3.0) {
                        calculateHeight(duration);
                        lastJumpTime = now;
                    }
                    
                    isFreeFalling = false;
                    indicator.classList.remove('active-jump');
                    statusText.innerText = "Landed & Saved";
                }
            });
        }

        function calculateHeight(t) {
            // Formula: Height = 1/2 * g * (t/2)^2
            // Simplifies to: h = 1.226 * t^2
            const g = 9.81;
            let h = (1/8) * g * Math.pow(t, 2);
            
            // Output display
            heightDisplay.innerText = h.toFixed(2) + "m";
        }

        startBtn.addEventListener('click', startTracking);
    </script>
</body>
</html>

