<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>WebRTC Real Call</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; background: #f4f4f4; }
        .status { color: green; font-weight: bold; margin-top: 20px; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; border-radius: 5px; border: none; background: #007bff; color: white; }
    </style>
</head>
<body>

    <h2>WebRTC Internet Calling</h2>
    <p>Apne mic ko allow karein aur "Start Call" dabayein</p>
    
    <button id="startBtn">Start Call</button>
    <button id="hangupBtn" style="background: red;">Hang Up</button>

    <div id="status" class="status">Status: Waiting...</div>

    <audio id="remoteAudio" autoplay controls style="display:none;"></audio>

    <script>
        let localStream;
        let peerConnection;
        const config = { iceServers: [{ urls: "stun:stun.l.google.com:19302" }] }; // Google ka free STUN server

        document.getElementById('startBtn').onclick = async () => {
            document.getElementById('status').innerText = "Status: Connecting...";
            
            // 1. Mic access karein
            localStream = await navigator.mediaDevices.getUserMedia({ audio: true });
            
            // 2. Peer Connection banayein
            peerConnection = new RTCPeerConnection(config);
            
            // 3. Apni audio stream add karein
            localStream.getTracks().forEach(track => peerConnection.addTrack(track, localStream));

            // 4. Jab samne wale ki awaaz aaye
            peerConnection.ontrack = (event) => {
                document.getElementById('remoteAudio').srcObject = event.streams[0];
                document.getElementById('status').innerText = "Status: Call Connected!";
            };

            // Yahan par Signaling (Socket.io) ka code aata hai jo dusre user ko signal bhejta hai
            console.log("Peer Connection taiyar hai. Ab signalling server ki zaroorat hai.");
        };

        document.getElementById('hangupBtn').onclick = () => {
            if(peerConnection) {
                peerConnection.close();
                document.getElementById('status').innerText = "Status: Call Ended.";
            }
        };
    </script>
</body>
</html>
